var P=Object.defineProperty;var B=i=>{throw TypeError(i)};var q=(i,s,a)=>s in i?P(i,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[s]=a;var b=(i,s,a)=>q(i,typeof s!="symbol"?s+"":s,a),v=(i,s,a)=>s.has(i)||B("Cannot "+a);var h=(i,s,a)=>(v(i,s,"read from private field"),a?a.call(i):s.get(i)),c=(i,s,a)=>s.has(i)?B("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(i):s.set(i,a),t=(i,s,a,n)=>(v(i,s,"write to private field"),n?n.call(i,a):s.set(i,a),a);var u=(i,s,a,n)=>({set _(r){t(i,s,r,a)},get _(){return h(i,s,n)}});import{e as x,r as A,f as y,h as F,z as m,K as w,L as z,t as D,N as f,m as j,a6 as _,J as S}from"./chunks/framework.CTVUMi5E.js";class T{constructor(s){b(this,"value");b(this,"next");this.value=s}}var l,E,g;class L{constructor(){c(this,l);c(this,E);c(this,g);this.clear()}enqueue(s){const a=new T(s);h(this,l)?(h(this,E).next=a,t(this,E,a)):(t(this,l,a),t(this,E,a)),u(this,g)._++}dequeue(){const s=h(this,l);if(s)return t(this,l,h(this,l).next),u(this,g)._--,s.value}peek(){if(h(this,l))return h(this,l).value}clear(){t(this,l,void 0),t(this,E,void 0),t(this,g,0)}get size(){return h(this,g)}*[Symbol.iterator](){let s=h(this,l);for(;s;)yield s.value,s=s.next}}l=new WeakMap,E=new WeakMap,g=new WeakMap;const N={bind(i,s,a){return i.bind(a)}};function I(i){if(!((Number.isInteger(i)||i===Number.POSITIVE_INFINITY)&&i>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");const s=new L;let a=0;const n=()=>{a--,s.size>0&&s.dequeue()()},r=async(p,k,d)=>{a++;const C=(async()=>p(...d))();k(C);try{await C}catch{}n()},o=(p,k,d)=>{s.enqueue(N.bind(r.bind(void 0,p,k,d))),(async()=>(await Promise.resolve(),a<i&&s.size>0&&s.dequeue()()))()},e=(p,...k)=>new Promise(d=>{o(p,d,k)});return Object.defineProperties(e,{activeCount:{get:()=>a},pendingCount:{get:()=>s.size},clearQueue:{value(){s.clear()}}}),e}const R=m("p",null,"Promise Limit 限制并发量为1",-1),Z=x({__name:"p-limit",setup(i){const s=A([]),a=A([]),n=I(1);async function r(e){return console.log(`fetching ${e}`),await new Promise(p=>setTimeout(p,1e3)),a.value.push(e),e}async function o(){s.value=[],a.value=[];const e=await Promise.all([n(()=>r("foo")),n(()=>r("bar")),n(()=>r("test"))]);console.log(e),s.value=e}return(e,p)=>(y(),F("div",null,[m("div",{btn:"",onClick:p[0]||(p[0]=k=>o())},"试一下"),R,(y(!0),F(w,null,z(a.value,(k,d)=>(y(),F("div",{key:d},"单次结果："+D(k),1))),128)),m("p",null,"result: "+D(s.value),1)]))}}),V=_("",19),O=_("",2),U=JSON.parse('{"title":"NodeJS","description":"","frontmatter":{},"headers":[],"relativePath":"src/notes/part/node.md","filePath":"src/notes/part/node.md","lastUpdated":1719909184000}'),$={name:"src/notes/part/node.md"},Q=Object.assign($,{setup(i){return(s,a)=>{const n=S("DemoContainer");return y(),F("div",null,[V,f(n,null,{default:j(()=>[f(Z)]),_:1}),O])}}});export{U as __pageData,Q as default};
