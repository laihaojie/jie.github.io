var _=Object.defineProperty;var P=(a,s,i)=>s in a?_(a,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[s]=i;var b=(a,s,i)=>(P(a,typeof s!="symbol"?s+"":s,i),i),v=(a,s,i)=>{if(!s.has(a))throw TypeError("Cannot "+i)};var k=(a,s,i)=>(v(a,s,"read from private field"),i?i.call(a):s.get(a)),c=(a,s,i)=>{if(s.has(a))throw TypeError("Cannot add the same private member more than once");s instanceof WeakSet?s.add(a):s.set(a,i)},p=(a,s,i,n)=>(v(a,s,"write to private field"),n?n.call(a,i):s.set(a,i),i);var u=(a,s,i,n)=>({set _(r){p(a,s,r,i)},get _(){return k(a,s,n)}});import{d as q,r as B,e as y,f as F,A as m,L as x,M as w,t as D,O as A,l as N,a7 as f,K as S}from"./chunks/framework.Du6ovwVv.js";class T{constructor(s){b(this,"value");b(this,"next");this.value=s}}var h,d,g;class j{constructor(){c(this,h,void 0);c(this,d,void 0);c(this,g,void 0);this.clear()}enqueue(s){const i=new T(s);k(this,h)?(k(this,d).next=i,p(this,d,i)):(p(this,h,i),p(this,d,i)),u(this,g)._++}dequeue(){const s=k(this,h);if(s)return p(this,h,k(this,h).next),u(this,g)._--,s.value}clear(){p(this,h,void 0),p(this,d,void 0),p(this,g,0)}get size(){return k(this,g)}*[Symbol.iterator](){let s=k(this,h);for(;s;)yield s.value,s=s.next}}h=new WeakMap,d=new WeakMap,g=new WeakMap;const z={bind(a,s,i){return a.bind(i)}};function L(a){if(!((Number.isInteger(a)||a===Number.POSITIVE_INFINITY)&&a>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");const s=new j;let i=0;const n=()=>{i--,s.size>0&&s.dequeue()()},r=async(e,t,E)=>{i++;const C=(async()=>e(...E))();t(C);try{await C}catch{}n()},o=(e,t,E)=>{s.enqueue(z.bind(r.bind(void 0,e,t,E))),(async()=>(await Promise.resolve(),i<a&&s.size>0&&s.dequeue()()))()},l=(e,...t)=>new Promise(E=>{o(e,E,t)});return Object.defineProperties(l,{activeCount:{get:()=>i},pendingCount:{get:()=>s.size},clearQueue:{value(){s.clear()}}}),l}const I=m("p",null,"Promise Limit 限制并发量为1",-1),O=q({__name:"p-limit",setup(a){const s=B([]),i=B([]),n=L(1);async function r(l){return console.log(`fetching ${l}`),await new Promise(e=>setTimeout(e,1e3)),i.value.push(l),l}async function o(){s.value=[],i.value=[];const l=await Promise.all([n(()=>r("foo")),n(()=>r("bar")),n(()=>r("test"))]);console.log(l),s.value=l}return(l,e)=>(y(),F("div",null,[m("div",{btn:"",onClick:e[0]||(e[0]=t=>o())},"试一下"),I,(y(!0),F(x,null,w(i.value,(t,E)=>(y(),F("div",{key:E},"单次结果："+D(t),1))),128)),m("p",null,"result: "+D(s.value),1)]))}}),V=f("",14),J=f("",2),H=JSON.parse('{"title":"NodeJS","description":"","frontmatter":{},"headers":[],"relativePath":"src/notes/part/node.md","filePath":"src/notes/part/node.md","lastUpdated":1716298831000}'),R={name:"src/notes/part/node.md"},X=Object.assign(R,{setup(a){return(s,i)=>{const n=S("DemoContainer");return y(),F("div",null,[V,A(n,null,{default:N(()=>[A(O)]),_:1}),J])}}});export{H as __pageData,X as default};
